@let state = state$ | async;
@let playerScore = playerScore$ | async;
@let opponentScore = opponentScore$ | async;

<div class="sm:w-3/4 md:w-1/2 lg:w-1/3 2xl:w-1/4 m-auto h-full flex flex-col justify-center">
    @if(state && playerScore && opponentScore){
    <div class="flex flex-col gap-2 items-center text-slate-500 mb-10">
        <div class="flex flex-col items-center transition-all"
            [class.scale-150]="state.ctx.currentPlayer === playerId()"
            [class.animate-pulse]="state.ctx.currentPlayer === playerId()">
            <span>Your Score:</span>
            <span class="text-3xl text-slate-200 font-mono">{{playerScore.score}}</span>
        </div>
        <div class="flex flex-col items-center transition-all"
            [class.scale-150]="state.ctx.currentPlayer !== playerId()"
            [class.animate-pulse]="state.ctx.currentPlayer !== playerId()">
            <span>Opponent Score:</span>
            <span class="font-mono">{{opponentScore.score}}</span>
        </div>
    </div>

    <div class="flex flex-col gap-1 items-center mx-5 mb-10">
        @for(row of state?.G?.board; track $index) {
        @let rowIndex = $index;
        <div class="flex flex-row gap-1 w-full">
            @for (bubble of row; track bubble!.id) {
            @let colIndex = $index;
            <div (click)="onPopBubble(rowIndex, colIndex)" class="w-1/2 aspect-square rounded-full"
                [class.bg-cyan-300]="bubble!.type === bubbleTypes.Cyan"
                [class.bg-purple-300]="bubble!.type === bubbleTypes.Magenta"
                [class.bg-amber-300]="bubble!.type === bubbleTypes.Yellow">
            </div>
            }
        </div>
        }
    </div> }
    @else {
    <img src="ripples.svg" />
    }
</div>